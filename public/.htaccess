# Apache Configuration for Next.js Static Export
# This file will be copied to the out/ directory during build

# Enable Rewrite Engine
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # Don't rewrite files or directories that exist
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # For directories, serve index.html if it exists
  RewriteCond %{REQUEST_FILENAME}/index.html -f
  RewriteRule ^(.*)$ $1/index.html [L]
  
  # Fallback to root index.html for SPA routing (if needed)
  # RewriteRule ^(.*)$ /index.html [L]
</IfModule>

# Cache Control Headers - force reload of all assets
<IfModule mod_headers.c>
  # HTML files
  <FilesMatch "\\.(html|htm)$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires 0
  </FilesMatch>

  # CSS, JS, images, fonts, JSON, etc. - disable caching
  <FilesMatch "\\.(css|js|json|txt|png|jpe?g|gif|ico|svg|woff2?|ttf|eot)$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires 0
  </FilesMatch>
</IfModule>

# Security Headers (optional but recommended)
<IfModule mod_headers.c>
  # Prevent clickjacking
  Header always set X-Frame-Options "SAMEORIGIN"
  
  # Prevent MIME type sniffing
  Header always set X-Content-Type-Options "nosniff"
  
  # Enable XSS protection
  Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# Compression (if not already enabled globally)
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json image/svg+xml
</IfModule>
